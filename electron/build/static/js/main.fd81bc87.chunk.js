(this.webpackJsonpwebsocky=this.webpackJsonpwebsocky||[]).push([[0],{31:function(e,t,c){"use strict";c.r(t);var a=c(1),s=c.n(a),n=c(14),r=c.n(n),o=c(2),l=c(3),i=c.n(l),u=c(5),b=c(0);var d=function(e){switch(e.type){case"tx":return Object(b.jsx)("i",{className:"bi bi-arrow-left-circle text-primary"});case"rx":return Object(b.jsx)("i",{className:"bi bi-arrow-right-circle text-warning"});case"open":return Object(b.jsx)("i",{className:"bi bi-check-circle text-success"});case"close":return Object(b.jsx)("i",{className:"bi bi-x-circle text-danger"});default:return Object(b.jsx)("div",{children:"?"})}},j=c(15),O=c.n(j);var f=function(e){var t=e.url,c=e.tx,s=Object(a.useState)([]),n=Object(o.a)(s,2),r=n[0],l=n[1],u=i()(t,{share:!0,onClose:function(){l((function(e){return e.concat({data:"Socket closed: ".concat(t),type:"close",timestamp:new Date})}))},onOpen:function(){l((function(e){return e.concat({data:"Socket opened: ".concat(t),type:"open",timestamp:new Date})}))},onReconnectStop:function(){l((function(e){return e.concat({data:"Reconnection limit reached: ".concat(t),type:"close",timestamp:new Date})}))}}).lastMessage,j=Object(a.useRef)(null);return Object(a.useEffect)((function(){null!=c&&l((function(e){return e.concat({data:c.data,type:"tx",timestamp:c.timestamp})}))}),[c,l]),Object(a.useEffect)((function(){null!=u&&l((function(e){return e.concat({data:u.data,type:"rx",timestamp:new Date})}))}),[u,l]),Object(a.useEffect)((function(){j&&j.current.addEventListener("DOMNodeInserted",(function(e){var t=e.currentTarget;t.scroll({top:t.scrollHeight,behavior:"smooth"})}))}),[j]),Object(b.jsx)("div",{className:"container-xxl pt-3 px-0",children:Object(b.jsx)("div",{className:"card",style:{height:"calc(100vh - 142px)"},children:Object(b.jsx)("div",{id:"msg-history",className:"card-body mh-100 overflow-auto p-3 striped-list",ref:j,children:r.map((function(e,t){return Object(b.jsxs)("div",{className:"msg-line",style:{display:"flex",flexWrap:"nowrap"},children:[Object(b.jsxs)("div",{className:"msg-header font-monospace mr-2",style:{width:"calc(14.85em)"},children:[Object(b.jsx)(O.a,{date:e.timestamp,format:"YY-MM-DD HH:mm:ss.SSS"}),"\xa0",Object(b.jsx)(d,{type:e.type})]}),Object(b.jsx)("div",{className:"msg-event font-monospace",style:{width:"calc(100% - 14.85em)"},children:e.data})]},t)}))})})})};var p=function(e){var t=e.url;switch(i()(t,{share:!0}).readyState){case l.ReadyState.CONNECTING:return Object(b.jsx)("i",{className:"bi bi-question-circle text-warning"});case l.ReadyState.CLOSED:case l.ReadyState.CLOSING:return Object(b.jsx)("i",{className:"bi bi-x-circle text-danger"});case l.ReadyState.OPEN:return Object(b.jsx)("i",{className:"bi bi-check-circle text-success"});case l.ReadyState.UNINSTANTIATED:return Object(b.jsx)("i",{className:"bi bi-x-circle text-danger"});default:return Object(b.jsx)("div",{children:"?"})}};var x=function(e){var t=e.default_url,c=e.url_setter,s=Object(u.a)("weboscket_url",t),n=Object(o.a)(s,2),r=n[0],l=n[1],i=Object(a.useState)(r),d=Object(o.a)(i,2),j=d[0],O=d[1],f=Object(a.useState)(j),x=Object(o.a)(f,2),m=x[0],h=x[1],y=Object(a.useCallback)((function(e){"Enter"===e.key&&(l(m),O(m),c(m),e.preventDefault(),e.target.blur())}),[l,O,c,m]);return Object(b.jsx)("nav",{className:"navbar navbar-light bg-light",children:Object(b.jsx)("form",{className:"container-fluid w-50",children:Object(b.jsxs)("div",{className:"input-group",children:[Object(b.jsx)("span",{className:"input-group-text my-auto",style:{height:"38px"},children:Object(b.jsx)(p,{url:j})}),Object(b.jsx)("input",{type:"text",className:"form-control text-center",defaultValue:j,onKeyDown:function(e){return y(e)},onChange:function(e){h(e.target.value)}})]})})})};var m=function(){var e=Object(a.useCallback)((function(){for(var e=document.querySelector("#msg-history");e.lastChild;)e.removeChild(e.lastChild)}),[]);return Object(b.jsx)("button",{className:"btn btn-outline-danger",type:"button",onClick:e,children:Object(b.jsx)("i",{class:"bi bi-eraser"})})},h=c(16);var y=function(){var e=Object(a.useCallback)((function(){var e="",t=document.querySelector("#msg-history").children;Object(h.a)(t).forEach((function(t){var c=t.querySelector(".msg-header"),a=t.querySelector(".msg-event");e+=c.textContent,e+=a.textContent,e+="\n"})),console.log(e);var c=document.createElement("a"),a=new Blob([e],{type:"text/plain"});c.href=URL.createObjectURL(a),c.download="websocket_log.txt",document.body.appendChild(c),c.click()}),[]);return Object(b.jsx)("button",{className:"btn btn-outline-primary",type:"button",onClick:e,children:Object(b.jsx)("i",{class:"bi bi-arrow-down-circle"})})};var g=function(e){var t=e.send,c=e.rs,s=Object(a.useState)(""),n=Object(o.a)(s,2),r=n[0],i=n[1],u=Object(a.useCallback)((function(e){t(r),e.preventDefault()}),[t,r]),d=Object(a.useState)(!0),j=Object(o.a)(d,2),O=j[0],f=j[1];Object(a.useEffect)((function(){r.length>0&&c===l.ReadyState.OPEN?f(!1):f(!0)}),[r,f,c]);var p=Object(a.useCallback)((function(e){"Enter"===e.key&&(e.preventDefault(),!1===O&&t(r))}),[t,r,O]);return Object(b.jsx)("form",{className:"container-xxl pt-2 px-0",children:Object(b.jsxs)("div",{className:"input-group",children:[Object(b.jsx)("input",{className:"form-control",type:"text",placeholder:"Message","aria-label":"default input example",onKeyDown:function(e){return p(e)},onChange:function(e){i(e.target.value)}}),Object(b.jsx)("button",{className:"btn btn-outline-primary",type:"button",onClick:u,disabled:O,children:Object(b.jsx)("i",{className:"bi bi-send"})}),Object(b.jsx)(y,{}),Object(b.jsx)(m,{})]})})};var v=function(e){var t=e.send,c=e.storage_key,s=e.readyState,n=e.label,r=e.group_focused,i=e.group_set_focused,d=Object(u.a)(c),j=Object(o.a)(d,2),O=j[0],f=j[1],p=Object(a.useState)(O),x=Object(o.a)(p,2),m=x[0],h=x[1],y=Object(a.useState)(!0),g=Object(o.a)(y,2),v=g[0],_=g[1],N=Object(a.useState)(!1),S=Object(o.a)(N,2),k=S[0],w=S[1],C=Object(a.useCallback)((function(){m.length>0&&t(m)}),[t,m]),E=Object(a.useCallback)((function(e){n===e.key&&m.length>0&&!k&&!r&&t(m)}),[m,n,t,k,r]),D=Object(a.useCallback)((function(e){"Enter"===e.key&&(e.preventDefault(),!1===v&&(f(m),t(m)))}),[t,m,v,f]);return Object(a.useEffect)((function(){_(s!==l.ReadyState.OPEN)}),[s,_]),Object(a.useEffect)((function(){i(k)}),[k,i]),Object(a.useEffect)((function(){return document.addEventListener("keydown",E),function(){return document.removeEventListener("keydown",E)}}),[E]),Object(b.jsx)("form",{className:"container-xxl pb-2 px-0",children:Object(b.jsxs)("div",{className:"input-group",children:[Object(b.jsx)("input",{className:"form-control",type:"text",placeholder:"Message","aria-label":"default input example",defaultValue:m,onFocus:function(){return w(!0)},onBlur:function(){return w(!1)},onKeyDown:function(e){return D(e)},onChange:function(e){h(e.target.value),f(e.target.value)}}),Object(b.jsxs)("button",{className:"btn btn-outline-primary",type:"button",onClick:C,disabled:v,children:[Object(b.jsx)("i",{className:"bi bi-send"})," ",n]})]})})};var _=function(e){var t=e.send,c=e.readyState,s=Object(a.useState)(!1),n=Object(o.a)(s,2),r=n[0],l=n[1];return Object(b.jsx)("div",{className:"container-fluid px-0",children:Object(b.jsxs)("div",{className:"row row-cols-1",children:[Object(b.jsx)("div",{className:"col px-1 pb-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_0",label:"0",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_1",label:"1",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_2",label:"2",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_3",label:"3",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_4",label:"4",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_5",label:"5",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_6",label:"6",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_7",label:"7",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_8",label:"8",group_set_focused:l,group_focused:r})}),Object(b.jsx)("div",{className:"col p-1",children:Object(b.jsx)(v,{send:t,readyState:c,storage_key:"send_btn_9",label:"9",group_set_focused:l,group_focused:r})})]})})};var N=function(){var e=Object(u.a)("weboscket_url","ws://localhost"),t=Object(o.a)(e,1)[0],c=Object(a.useState)(t),s=Object(o.a)(c,2),n=s[0],r=s[1],l=i()(n,{shouldReconnect:function(){return!0},share:!0}),d=l.sendMessage,j=l.readyState,O=Object(a.useState)(),p=Object(o.a)(O,2),m=p[0],h=p[1],y=function(e){h({data:e,timestamp:(new Date).toISOString()}),d(e)};return Object(b.jsxs)("div",{children:[Object(b.jsx)(x,{default_url:n,url_setter:r}),Object(b.jsxs)("div",{className:"row mb-0 w-100",children:[Object(b.jsxs)("div",{className:"col-8 offset-2 mb-0 mr-0 ml-0",children:[Object(b.jsx)(f,{url:n,tx:m}),Object(b.jsx)(g,{rs:j,send:y})]}),Object(b.jsx)("div",{className:"col-2 mt-0 mb-0 mr-0 ml-0 pt-3",children:Object(b.jsx)(_,{readyState:j,send:y})})]})]})};r.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(N,{})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.fd81bc87.chunk.js.map